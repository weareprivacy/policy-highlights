(window.policyHighlightsJsonpFunction=window.policyHighlightsJsonpFunction||[]).push([[1],{Hglc:function(t,e,i){},tjUo:function(t,e,i){"use strict";i.r(e);i("Hglc");function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(i,!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=o({autoHighlight:!0,highlights:[],container:document},e,{backgroundColor:o({keyword:"#ffff00",action:"#fcf1cd"},e.backgroundColor),textColor:o({keyword:"#000000",action:"#000000"},e.textColor)}),this.positionMap={},this.keywordDetails=null,this.highlights=[],this.typeStyles={},this.singularTypesMap={keywords:"keyword",actions:"action"},this.invalidNodeTypes=["body","head","html","script","style","title","form"],this.config.autoHighlight&&this.parseHighlights()}var e,i,n;return e=t,n=[{key:"getHighlightHTML",value:function(e){var i=t.getHTMLTag({value:e.name,className:"name"})+t.getHTMLTag({value:e.description,className:"description"});return t.getHTMLTag({value:i,className:"highlight"})}},{key:"getHTMLTag",value:function(t){var e=t.value,i=void 0===e?"":e,n=t.className,o=void 0===n?"":n,a=t.style,l=void 0===a?"":a,s=t.tag,h=void 0===s?"div":s;return i&&i.length>0&&"<".concat(h,' class="policyHighlight__').concat(o,'" style="').concat(l,'">').concat(i,"</").concat(h,">")}}],(i=[{key:"parseHighlights",value:function(){this.highlights=[];for(var t=Object.keys(this.singularTypesMap),e=this.config.highlights.length-1;e>=0;e--)for(var i=this.config.highlights[e],n=t.length-1;n>=0;n--){var o=t[n];if(i[o]&&i[o].length>0){this.addTypeStyle({type:this.singularTypesMap[o]});for(var a=i[o].split(","),l=a.length-1;l>=0;l--){var s=a[l];s.length>0&&(this.addTextPosition({text:s,index:e}),this.highlights.push({type:this.singularTypesMap[o],regex:new RegExp("(^|\\W)"+s.replace(/[\\^$*+.?[\]{}()|]/,"")+"($|\\W)","gim")}))}}}this.highlight()}},{key:"highlight",value:function(){if(0!==this.highlights.length){this.config.container.normalize();for(var t=this.config.container.firstChild,e=[];null!=t;){if(t.nodeType!=Node.TEXT_NODE||t.parentNode.dataset.highlight||-1!==this.invalidNodeTypes.indexOf(t.parentNode.nodeName.toLowerCase())){if(t.nodeType==Node.ELEMENT_NODE&&null!=t.firstChild){e.push(t),t=t.firstChild;continue}}else{var i="string"==typeof t.textContent?t.textContent:t.innerText;this.findHighlights({text:i,foundCallback:function(e,i){t.parentNode.replaceChild(e,t),t=i}})}for(;null!=t&&null==t.nextSibling;)t=e.pop();null!=t&&(t=t.nextSibling)}e=void 0,t=void 0}}},{key:"findHighlights",value:function(t){var e=t.text,i=void 0===e?"":e,n=t.foundCallback,o=void 0===n?function(){}:n,a=this.getHighlightsMap({text:i}),l=Object.values(a);if(l.length>0)for(var s=document.createDocumentFragment(),h=l.length,r=0;r<h;r++){if(l[r].index>0)if(0===r)s.appendChild(document.createTextNode(i.substr(0,l[r].index)));else{var g=l[r-1].index+l[r-1].length;g<l[r].index&&s.appendChild(document.createTextNode(i.substr(g,l[r].index-g)))}var c=this.getHighlightSpan(l[r]);s.appendChild(c),r===h-1&&(l[r].index+l[r].length<i.length&&s.appendChild(document.createTextNode(i.substr(l[r].index+l[r].length))),o(s,c))}}},{key:"getHighlightsMap",value:function(t){var e=t.text,i=void 0===e?"":e,n={};if(i.length>0)for(var o=this.highlights.length-1;o>=0;o--){var a=void 0;do{null!=(a=this.highlights[o].regex.exec(i))&&(n[a.index]={type:this.highlights[o].type,index:a.index,length:a[0].length,text:a[0]})}while(null!=a);a=void 0}return n}},{key:"getHighlightSpan",value:function(t){var e=t.type,i=t.text,n=document.createElement("span");return n.setAttribute("style",this.typeStyles[e]),n.setAttribute("data-type",e),n.setAttribute("data-highlight","true"),n.appendChild(document.createTextNode(i)),n.addEventListener("mouseover",this.showDetails.bind(this)),n.addEventListener("mouseout",this.hideDetails.bind(this)),n}},{key:"getHighlightStyle",value:function(t){var e=t.type,i=void 0===e?"keyword":e,n=t.style,o=void 0===n?[]:n;return this.config.backgroundColor[i]&&this.config.backgroundColor[i].length>0&&o.push("background-color:".concat(this.config.backgroundColor[i],";")),this.config.textColor[i]&&this.config.textColor[i].length>0&&o.push("color:".concat(this.config.textColor[i],";")),o.join("")}},{key:"addTypeStyle",value:function(t){var e=t.type;e in this.typeStyles||(this.typeStyles[e]=this.getHighlightStyle({type:e,style:["display:inline-block;margin-left:4px;margin-right:4px;"]}))}},{key:"addTextPosition",value:function(t){var e=t.text,i=t.index,n=e.replace(/[.']/g,"").replace(/[\-]/g," ");n in this.positionMap?-1===this.positionMap[n].indexOf(i)&&this.positionMap[n].push(i):this.positionMap[n]=[i]}},{key:"showDetails",value:function(t){var e=t.target.innerHTML.replace(/[\\^$*+.?[\]{}()<>|’'"“”;:\/©®]|(&nbsp;)/g,"").replace(/[\-&,]/g," ").trim().toLowerCase();if(e in this.positionMap){this.hideDetails();var i=t.pageY-t.offsetY+t.target.clientHeight+1,n=t.pageX-t.offsetX+t.target.clientWidth/2-42,o=document.createElement("div");o.setAttribute("class","policyHighlight__popup"),o.setAttribute("style","top:".concat(i,"px;left:").concat(n,"px;")),o.innerHTML=this.getDetailsHTML(e,t.target.dataset.type),document.getElementsByTagName("body")[0].appendChild(o),this.keywordDetails=o}}},{key:"hideDetails",value:function(){this.keywordDetails&&this.keywordDetails.parentNode.removeChild(this.keywordDetails),this.keywordDetails=null}},{key:"getDetailsHTML",value:function(e,i){var n=this,o=e;if(i){var a=this.getHighlightStyle({type:i});o+=": "+t.getHTMLTag({value:i,style:a,tag:"span",className:"tag"})}var l=t.getHTMLTag({value:o,className:"text"});if(i){var s=["An important",i,"in the below"];this.positionMap[e].length>1?s.push("".concat(this.positionMap[e].length," highlights.")):s.push("highlight."),l+=t.getHTMLTag({value:s.join(" "),className:"type"})}var h=this.positionMap[e].map((function(e){return t.getHighlightHTML(n.config.highlights[e])}));return l+=t.getHTMLTag({value:h.join(""),className:"highlights"}),t.getHTMLTag({value:l,className:"details"})}}])&&l(e.prototype,i),n&&l(e,n),t}();e.default=s}}]);